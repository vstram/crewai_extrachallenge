data_analysis_task:
  description: >
    CRITICAL: You MUST use Database Statistical Analysis Tool for memory-efficient analysis, then create visualizations.

    PHASE 1 - DATABASE STATISTICAL ANALYSIS (MANDATORY):

    1. Call "Database Statistical Analysis Tool" with: {"analysis_type": "descriptive"}
    2. Call "Database Statistical Analysis Tool" with: {"analysis_type": "data_quality"}
    3. Call "Database Statistical Analysis Tool" with: {"analysis_type": "distribution", "target_column": "Class"}

    PHASE 2 - VISUALIZATIONS (MANDATORY):

    4. Call "Fraud Detection Visualization Tool" with: {"chart_type": "fraud_comparison", "data_description": "Fraud vs legitimate counts", "title": "Transaction Class Distribution", "filename": "fraud_comparison"}

    5. Call "Fraud Detection Visualization Tool" with: {"chart_type": "correlation_heatmap", "data_description": "Feature correlations", "title": "Feature Correlation Matrix", "filename": "correlation_heatmap"}

    PHASE 3 - VALIDATION:

    6. Call "Task Validation Tool" with: {"task_name": "data_analysis_task", "required_images": ["fraud_comparison", "correlation_heatmap"], "validation_type": "images_exist"}

    Execute database analysis calls FIRST (they are fast and memory-efficient). Then create visualizations.
  expected_output: >
    A detailed statistical analysis report in markdown format including:
    - Dataset overview (number of transactions, features, data types)
    - Statistical summaries for all features in table format
    - Data quality assessment (missing values, outliers)
    - Distribution analysis of fraud vs legitimate transactions (if Class column exists)
    - Key findings and data preprocessing recommendations
    MUST include these visualizations using the Fraud Detection Visualization Tool:
    - Create a 'fraud_comparison' chart showing fraud vs legitimate transaction counts
    - Create a 'distribution' chart showing transaction amount distributions
    - Create a 'correlation_heatmap' for feature correlations
    Include all chart images in the markdown report with proper image references
  agent: data_analyst

pattern_recognition_task:
  description: >
    You must directly call tools to analyze patterns and create visualizations. Do not describe what you will do - just call the tools.

    MANDATORY TOOL CALLS - Execute these exact tool calls. If statistical analysis fails, continue with visualizations:

    1. Call "Database Statistical Analysis Tool" with: {"analysis_type": "correlation"}

    VISUALIZATION CALLS - Execute all visualizations regardless of previous step results:
    2. Call "Fraud Detection Visualization Tool" with: {"chart_type": "scatter", "data_description": "Relationship between key features", "title": "Feature Relationships", "filename": "scatter"}
    3. Call "Fraud Detection Visualization Tool" with: {"chart_type": "time_series", "data_description": "Fraud incidents over time", "title": "Time Series Analysis", "filename": "time_series"}
    4. Call "Fraud Detection Visualization Tool" with: {"chart_type": "feature_importance", "data_description": "Most predictive features", "title": "Feature Importance", "filename": "feature_importance"}
    5. Call "Fraud Detection Visualization Tool" with: {"chart_type": "box_plot", "data_description": "Feature distributions by class", "title": "Distribution Comparison", "filename": "box_plot"}

    VALIDATION:
    6. Call "Task Validation Tool" with: {"task_name": "pattern_recognition_task", "required_images": ["scatter", "time_series", "feature_importance", "box_plot"], "validation_type": "images_exist"}

    Execute these tool calls immediately. If early steps fail, still proceed with all visualizations.
  expected_output: >
    A comprehensive pattern analysis report in markdown format including:
    - Identified fraud patterns and their characteristics in table format
    - Unusual transaction patterns and anomalies
    - Feature correlations that indicate fraud
    - Time-based fraud patterns
    - Amount-based fraud indicators
    - Recommended rules or thresholds for fraud detection
    MUST include these visualizations using the Fraud Detection Visualization Tool:
    - Create a 'scatter' plot showing relationship between key features
    - Create a 'time_series' chart for fraud incidents over time
    - Create a 'feature_importance' chart highlighting most predictive features
    - Create a 'box_plot' comparing feature distributions by class
    Include all chart images in the markdown report with proper image references
  agent: pattern_recognition_agent

classification_task:
  description: >
    You must directly call tools to analyze classification and outliers. Do not describe - just execute tool calls.

    MANDATORY TOOL CALLS - Execute these exact tool calls. If statistical analysis fails, continue with visualization:

    1. Call "Database Statistical Analysis Tool" with: {"analysis_type": "outliers"}

    VISUALIZATION CALLS - Execute regardless of previous step results:
    2. Call "Fraud Detection Visualization Tool" with: {"chart_type": "histogram", "data_description": "Transaction amount distribution", "title": "Transaction Amount Histogram", "filename": "amount_histogram"}

    VALIDATION:
    3. Call "Task Validation Tool" with: {"task_name": "classification_task", "required_images": ["amount_histogram"], "validation_type": "images_exist"}

    Execute these tool calls immediately. If early steps fail, still proceed with visualization.
  expected_output: >
    A classification analysis report in markdown format including:
    - Classification methodology and criteria used
    - Summary statistics of classifications in table format (number of fraud vs legitimate)
    - Confidence levels and uncertainty analysis with tables
    - Risk assessment for different transaction types
    - Recommendations for threshold adjustments
    - Cost-benefit analysis of classification decisions
    MUST include this visualization using the Fraud Detection Visualization Tool:
    - Create a 'histogram' chart showing confidence score distributions
    Include the chart image in the markdown report with proper image reference
  agent: classification_agent

reporting_task:
  description: >
    Create a comprehensive fraud detection analysis report. You MUST execute ALL steps in order.

    STEP 1 - MANDATORY - Get Available Images:
    Call "Image Verification Tool" with: {"action": "list_available"}
    COPY the exact markdown references from the tool output table.

    STEP 2 - MANDATORY - Create Report:
    Write a comprehensive report including findings from previous agents:

    # Fraud Detection Analysis Report

    ## Executive Summary
    [Include key findings and business recommendations]

    ## Methodology
    [Describe the 4-step analysis process]

    ## Data Analysis Results
    [Include correlation heatmap and fraud comparison using EXACT references from Step 1]

    ## Pattern Recognition Results
    [Include scatter plot, time series, and feature importance using EXACT references from Step 1]

    ## Classification Analysis
    [Include histogram using EXACT references from Step 1]

    ## Risk Assessment and Recommendations
    [Business recommendations and strategies]

    CRITICAL: Use ONLY the exact markdown image references provided by Step 1 tool output. Do NOT create new image references.

    STEP 3 - MANDATORY - Format Final Report:
    Call "Markdown Formatter Tool" with: {"markdown_content": "[paste your complete report from step 2]"}

    SUBMIT ONLY the formatted output from Step 3 as your final response.
  expected_output: >
    A comprehensive fraud detection report in markdown format that includes:

    - ALL 6 available images with exact markdown references from Image Verification Tool
    - Findings from previous agent analyses
    - Proper markdown formatting from Markdown Formatter Tool
    - Content organized in sections: Executive Summary, Methodology, Data Analysis, Pattern Recognition, Classification Analysis, Risk Assessment

    CRITICAL REQUIREMENTS:
    1. Must include ALL available images: correlation_heatmap.png, fraud_comparison.png, scatter.png, time_series.png, feature_importance.png, amount_histogram.png
    2. Must use exact markdown references from Image Verification Tool output
    3. Must be formatted by Markdown Formatter Tool
    4. Must NOT reference non-existent images
  agent: reporting_analyst
